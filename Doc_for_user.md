<!--
CodeEditor - Documentation
Copyright (C) 2025 ToMaTiKkk
SPDX-License-Identifier: GPL-3.0-or-later
-->

**Руководство пользователя CodeEdit**
*   **1. Добро пожаловать в CodeEdit!** 
*   **2. Начало работы**
    *   Первый запуск и знакомство с интерфейсом
    *   Установка вашего никнейма
*   **3. Работа с файлами и проектами**
    *   Открытие и сохранение файлов
    *   Создание новых файлов
    *   Работа с папками (открытие проекта)
    *   Использование панели файлов
*   **4. Редактор кода: ваш умный помощник**
    *   Основные элементы: нумерация строк, подсветка синтаксиса
    *   Поиск текста в файле
    *   Интеллектуальные функции (LSP):
        *   Автодополнение кода
        *   Всплывающие подсказки (Hover)
        *   Обнаружение ошибок и предупреждений (Диагностика)
        *   Переход к определению символа
    *   Настройка интеллектуальных функций (LSP-серверы)
*   **5. Совместная работа в реальном времени**
    *   Что такое сессии совместной работы?
    *   Создание новой сессии (пароль, сохранение)
    *   Присоединение к существующей сессии
    *   Как происходит синхронизация кода и курсоров
    *   Управление участниками сессии:
        *   Список пользователей и их информация
        *   Статус администратора и его передача
        *   Мьют (временный запрет редактирования) для участников
    *   Сохранение сессии на сервере (для администратора)
    *   Выход из сессии
*   **6. Общение с командой: Встроенный чат**
    *   Открытие и использование чата
    *   Отправка и получение сообщений
    *   Уведомления о новых сообщениях
*   **7. Встроенный терминал**
    *   Открытие и использование терминала
    *   Выполнение команд (включая компиляцию и запуск кода)
*   **8. Управление задачами (Список дел / ToDo List)**
    *   Открытие менеджера задач
    *   Добавление, редактирование и удаление задач
    *   Установка сроков выполнения
    *   Отметка задач как выполненных
    *   Сохранение и загрузка списка задач
*   **9. Настройка внешнего вида: Темы**
    *   Переключение между светлой и темной темой
*   **10. Закрытие приложения** (Проверка несохраненных изменений)
*   **11. Устранение неполадок и FAQ** (Будет наполняться)
*   **12. Основные горячие клавиши**

## 1. Добро пожаловать в CodeEdit!

CodeEdit — это современное приложение для написания и редактирования кода, созданное для вашего удобства и продуктивности. Оно особенно полезно, если вы работаете над проектами в команде, благодаря мощным функциям совместной работы в реальном времени.

**Ключевые возможности CodeEdit:**

*   **Умный редактор кода:** Пишите код с комфортом благодаря подсветке синтаксиса, нумерации строк, автоматическому дополнению кода, мгновенному обнаружению ошибок и полезным всплывающим подсказкам.
*   **Работа с файлами и проектами:** Легко открывайте отдельные файлы или целые папки (проекты), создавайте новые файлы и сохраняйте свою работу.
*   **Совместная работа:** Приглашайте коллег в защищенные паролем сессии для одновременного редактирования файлов. Вы будете видеть курсоры друг друга и все изменения в реальном времени.
*   **Встроенный чат:** Обсуждайте задачи и код с участниками сессии прямо в приложении, не переключаясь на другие мессенджеры.
*   **Интегрированный терминал:** Выполняйте команды, компилируйте код и запускайте свои программы, не покидая CodeEdit.
*   **Управление задачами:** Следите за своими делами с помощью встроенного списка задач (ToDo List) с возможностью установки сроков.
*   **Настраиваемый интерфейс:** Выбирайте между светлой и темной темой оформления для комфортной работы в любое время суток.

Это руководство поможет вам освоить все функции CodeEdit и начать работу максимально эффективно.

## 2. Начало работы

### Первый запуск и знакомство с интерфейсом

При первом запуске CodeEdit вы увидите главное окно программы. По умолчанию используется шрифт "Fira Code" (12 размер), который отлично подходит для отображения кода. Окно приложения имеет заголовок "CodeEdit".

Основные элементы интерфейса:
*   **Строка меню:** Вверху окна (File, Edit, View и т.д.) – доступ ко всем функциям.
*   **Панель инструментов (частично в строке меню):** Справа в строке меню находятся кнопки для быстрого запуска кода и открытия/закрытия чата.
*   **Панель файлов:** Обычно слева, отображает дерево файлов и папок вашего проекта.
*   **Редактор кода:** Центральная, самая большая область, где вы будете писать код.
*   **Статус-бар:** Внизу окна, показывает различную полезную информацию (статус LSP, количество ошибок, ваш статус мьюта и т.д.).
*   **Панель чата/терминала:** Могут появляться справа или снизу по вашему выбору.

### Установка вашего никнейма

При первом запуске (или если никнейм не был установлен ранее) CodeEdit попросит вас ввести **никнейм**. Этот никнейм будет использоваться для вашей идентификации в совместных сессиях и в чате. Если вы не введете никнейм, программа назначит вам случайное имя.

## 3. Работа с файлами и проектами

CodeEdit предоставляет все необходимые инструменты для управления вашими файлами и проектами.

### Открытие и сохранение файлов

*   **Открыть файл:**
    1.  В меню выберите `Файл` > `Открыть файл...`.
    2.  В стандартном диалоговом окне выберите нужный файл и нажмите "Открыть".
    3.  Содержимое файла отобразится в редакторе кода.
    *   Если вы находитесь в совместной сессии, содержимое этого файла будет также отправлено другим участникам.
*   **Открыть файл из панели файлов:**
    *   Дважды щелкните по файлу в **Панели файлов** (см. ниже), чтобы открыть его.
*   **Сохранить файл:**
    *   Чтобы сохранить изменения в текущем файле, выберите `Файл` > `Сохранить` (или используйте стандартную горячую клавишу, например, `Ctrl+S`).
*   **Сохранить файл как...:**
    1.  Если вы хотите сохранить файл под новым именем или в другом месте, выберите `Файл` > `Сохранить как...`.
    2.  Укажите новое имя и местоположение в диалоговом окне.

### Создание новых файлов

1.  Выберите в меню `Файл` > `Новый файл`.
2.  Область редактора кода очистится, и вы сможете начать работу над новым файлом.
3.  Не забудьте сохранить новый файл (`Файл` > `Сохранить` или `Сохранить как...`), чтобы дать ему имя.
    *   В совместной сессии информация о создании нового (пустого) файла также будет отправлена другим участникам.

### Работа с папками (открытие проекта)

Для удобства работы с набором связанных файлов вы можете открыть целую папку как проект:
1.  Выберите в меню `Файл` > `Открыть папку...`.
2.  В диалоговом окне выберите нужную папку.
3.  Структура этой папки (файлы и подпапки) отобразится в **Панели файлов**.
    *   Если в вашем проекте используются интеллектуальные функции (LSP), они будут перезапущены для анализа файлов в этой новой корневой папке.

### Использование панели файлов

Панель файлов (обычно расположена слева) отображает иерархическую структуру (дерево) открытой папки проекта.
*   Вы можете разворачивать и сворачивать папки, чтобы увидеть их содержимое.
*   Двойной щелчок по файлу открывает его в редакторе.
*   В панели отображаются только имена файлов и папок (без информации о размере, дате и т.п.).

### Проверка несохраненных изменений

Если вы пытаетесь закрыть файл с несохраненными изменениями, открыть другой файл или выйти из программы, CodeEdit предупредит вас и предложит сохранить изменения. Вы сможете выбрать: сохранить, не сохранять или отменить действие.

## 4. Редактор кода: ваш умный помощник

Центральное место в CodeEdit занимает редактор кода, оснащенный множеством функций для облегчения вашей работы.

### Основные элементы: нумерация строк, подсветка синтаксиса

*   **Нумерация строк:** Слева от области кода отображается панель с номерами строк. Это помогает легко ориентироваться в коде и ссылаться на конкретные строки.
    *   Текущая строка, на которой находится курсор, подсвечивается в области нумерации.
    *   Эта область также используется для отображения **индикаторов ошибок и предупреждений** от интеллектуальных функций (см. ниже). При наведении мыши на такой индикатор появится всплывающая подсказка с описанием проблемы.
*   **Подсветка синтаксиса:** CodeEdit автоматически распознает язык программирования (в текущей версии особенно хорошо поддерживается C++) и выделяет цветом различные части кода (ключевые слова, комментарии, строки и т.д.). Это значительно улучшает читаемость кода.

### Поиск текста в файле

1.  Чтобы найти текст, нажмите `Ctrl+F` (или выберите `Правка` > `Найти...` в меню).
2.  В верхней части редактора появится панель поиска.
3.  Введите искомый текст.
4.  Используйте кнопки "Следующий" и "Предыдущий" для навигации по найденным совпадениям.
5.  Все найденные вхождения будут подсвечены в коде.
6.  Нажмите "Закрыть" на панели поиска, чтобы ее скрыть.

### Интеллектуальные функции (LSP)

CodeEdit использует технологию Language Server Protocol (LSP) для предоставления "умных" функций, которые помогают писать код быстрее и избегать ошибок. Эти функции работают для поддерживаемых языков (например, C++), если соответствующий LSP-сервер настроен.

*   **Автодополнение кода (Completion):**
    *   Когда вы начинаете печатать, CodeEdit предлагает варианты для завершения имен переменных, функций, методов и т.д.
    *   Список предложений обычно появляется автоматически или по нажатию `Ctrl+Пробел`.
    *   Используйте клавиши со стрелками для выбора варианта и `Enter` для вставки.
    *   Рядом с предложениями может отображаться дополнительная информация (тип, документация).

*   **Всплывающие подсказки (Hover):**
    *   Наведите курсор мыши на элемент кода (например, имя функции или переменной) и немного подождите. Появится всплывающая подсказка с информацией об этом элементе (его тип, документация, откуда он импортирован и т.д.).

*   **Обнаружение ошибок и предупреждений (Диагностика):**
    *   LSP-сервер анализирует ваш код в фоновом режиме. Найденные проблемы отображаются:
        *   **Маркерами рядом с номерами строк:** Красный для ошибок, оранжевый для предупреждений, синий для информации.
        *   **Подчеркиваниями в коде.**
        *   **В статус-баре:** Отображается общее количество ошибок/предупреждений и статус LSP-сервера (например, "LSP: готов", "LSP: 2 ошибки, 1 предупреждение").
    *   При наведении мыши на проблемный участок кода или маркер у номера строки, появится подсказка с описанием проблемы.

*   **Переход к определению символа (Go to Definition):**
    *   Установите курсор на имя функции, переменной, класса и т.д., и нажмите `F12` (или выберите соответствующий пункт в контекстном меню).
    *   CodeEdit перенесет вас к месту в коде, где этот символ был определен (даже если это другой файл в вашем проекте).

*   **Навигация по ошибкам/предупреждениям:**
    *   Нажмите `F2` для перехода к следующей ошибке/предупреждению в файле.
    *   Нажмите `Shift+F2` для перехода к предыдущей.

### Настройка интеллектуальных функций (LSP-серверы)

CodeEdit пытается автоматически найти и использовать установленные в вашей системе LSP-серверы. Однако, если у вас возникли проблемы или вы хотите использовать конкретный сервер:
1.  Выберите в меню `Инструменты` > `Настройки LSP...` (или аналогичный пункт).
2.  Откроется диалоговое окно, где вы можете указать пути к исполняемым файлам LSP-серверов для различных языков.
3.  Приложение сохранит эти настройки для будущих сеансов.
    *   Если LSP-сервер для текущего языка не найден, CodeEdit может предложить вам настроить его.

## 5. Совместная работа в реальном времени

Главная сила CodeEdit – в возможности совместного редактирования кода. Вы можете работать над одним проектом с коллегами одновременно, видя все изменения мгновенно. Сетевое взаимодействие происходит через WebSocket-сервер по адресу `ws://YOUR_WEBSOCKET_HOST:YOUR_WEBSOCKET_PORT`.

### Что такое сессии совместной работы?

Сессия – это общая рабочая среда на сервере, к которой подключаются несколько пользователей. Все участники видят один и тот же файл и могут его редактировать. Каждому пользователю присваивается уникальный идентификатор (`client_id`) и используется его никнейм.

### Создание новой сессии

1.  В меню выберите `Сессия` > `Создать сессию`.
2.  Откроется диалоговое окно **"Параметры сессии"**:
    *   **Пароль:** Введите пароль для вашей сессии (минимум 4 символа). Он понадобится другим для подключения.
    *   **Сохранить сессию (опционально):**
        *   Отметьте галочку "Сохранить сессию", если хотите, чтобы код и информация о сессии сохранились на сервере после отключения всех участников.
        *   Если галочка отмечена, вы сможете указать, на сколько дней сохранить сессию (от 1 до 7).
    *   Нажмите "Создать".
3.  После успешного создания вы получите **ID сессии**. Сообщите этот ID и пароль тем, кого хотите пригласить.
4.  Вы, как создатель, автоматически становитесь **администратором** сессии.

### Присоединение к существующей сессии

1.  Узнайте у создателя ID сессии и пароль.
2.  В меню выберите `Сессия` > `Присоединиться к сессии`.
3.  Введите полученные ID и пароль в появившемся диалоге.
4.  Нажмите "Присоединиться".
    *   В случае ошибки (неверный пароль, сессия не найдена) вы увидите сообщение.

### Как происходит синхронизация кода и курсоров

*   Все ваши изменения в коде (вставка, удаление текста) и перемещения курсора немедленно отправляются на сервер и другим участникам.
*   Вы также мгновенно видите изменения от других.
*   **Курсоры других пользователей:** В редакторе вы будете видеть цветные курсоры других участников с их никнеймами. Строка, на которой находится курсор другого пользователя, также может подсвечиваться. Это помогает избежать конфликтов при редактировании.

### Управление участниками сессии

*   **Список пользователей:**
    *   Чтобы увидеть список участников сессии, нажмите кнопку "Список пользователей" (иконка с несколькими человечками, обычно в менюбаре) или выберите соответствующий пункт в меню.
    *   В выпадающем списке отобразятся никнеймы, цвета и статусы (админ, мьют) участников.
    *   Кликнув на пользователя, можно вызвать контекстное меню с действиями.
*   **Информация о пользователе:** Выбрав пользователя, вы можете посмотреть его детальную информацию (ID, статус мьюта).
*   **Статус администратора и его передача:**
    *   Создатель сессии – администратор по умолчанию.
    *   Администратор может мьютить других, передавать права администратора и сохранять сессию.
    *   Чтобы передать права, администратор должен выбрать другого пользователя в списке и в контекстном меню выбрать "Передать права администратора".
*   **Мьют (временный запрет редактирования) для участников:**
    *   Администратор может временно "замьютить" участника, запретив ему редактировать код.
    *   Для этого нужно выбрать пользователя в списке и в контекстном меню выбрать "Замьютить/Размьютить". Можно указать длительность мьюта (в секундах, 0 – бессрочно).
    *   Замьюченный пользователь увидит уведомление, а в его редакторе будет заблокирован ввод. В статус-баре будет отображаться оставшееся время мьюта.
    *   Администратор может размьютить пользователя тем же способом.
    *   Информация о статусе мьюта других участников также видна в списке пользователей.

### Сохранение сессии на сервере (для администратора)

Администратор может сохранить текущее состояние сессии (код, список участников) на сервере:
1.  Выберите в меню `Сессия` > `Сохранить сессию на сервере`.
2.  Укажите, на сколько дней сохранить сессию.
    *   Если при создании сессии была выбрана опция сохранения, она может быть уже активна.
    *   В случае успеха вы увидите сообщение в статус-баре.

### Выход из сессии

*   Выберите в меню `Сессия` > `Покинуть сессию`.
*   Вы будете отключены от сервера.

## 6. Общение с командой: Встроенный чат

CodeEdit имеет встроенный чат для общения с участниками совместной сессии.

### Открытие и использование чата

*   Нажмите кнопку с иконкой сообщения (обычно в правом верхнем углу менюбара). Это действие покажет или скроет панель чата.
*   Панель чата обычно появляется справа.

### Отправка и получение сообщений

*   **Отправка:** Введите сообщение в поле ввода внизу панели чата и нажмите `Enter` или кнопку "Отправить". Ваше сообщение появится в окне чата с пометкой "Вы".
*   **Получение:** Сообщения от других участников отображаются с их никнеймом и временем отправки.
*   Окно чата автоматически прокручивается вниз при поступлении новых сообщений.

### Уведомления о новых сообщениях

Если окно CodeEdit свернуто или чат скрыт, а вам пришло новое сообщение, вы можете получить системное уведомление (всплывающее сообщение на рабочем столе). Иконка кнопки чата также может измениться.

## 7. Встроенный терминал

CodeEdit предоставляет встроенный эмулятор терминала для выполнения команд прямо в приложении.

### Открытие и использование терминала

*   Выберите в меню `Вид` > `Терминал` (или нажмите на соответствующую иконку/пункт меню `ui->actionTerminal`). Это действие покажет или скроет панель терминала.
*   Панель терминала обычно появляется в нижней части окна, под редактором кода и панелью файлов.
*   При открытии терминала фокус ввода автоматически устанавливается на него.

### Выполнение команд (включая компиляцию и запуск кода)

*   Вы можете вводить и выполнять любые команды, доступные в вашей системной оболочке (например, `ls`, `cd`, `git`, команды компиляции `gcc main.c -o main`, `./main` и т.д.).
*   **Запуск кода:** Кнопка "Запустить код" (иконка "play" в менюбаре) автоматически формирует и отправляет в терминал команду для компиляции и/или запуска текущего файла (в зависимости от его расширения). Если терминал был скрыт, он откроется.
*   **Копирование:** Выделите текст в терминале и используйте стандартную комбинацию для копирования (например, `Ctrl+Shift+C` или через контекстное меню).
*   **Ссылки:** Если в выводе терминала есть URL, вы можете кликнуть по нему, и он откроется в браузере.

## 8. Управление задачами (Список дел / ToDo List)

В CodeEdit есть удобный менеджер задач, чтобы вы могли отслеживать свои дела.

### Открытие менеджера задач

1.  Выберите в меню `Инструменты` > `Список дел` (соответствует `ui->actionToDoList`).
2.  Откроется отдельное окно "Список дел".

### Добавление, редактирование и удаление задач

*   **Добавить задачу:**
    1.  Введите текст задачи в поле "Введите задачу..." наверху окна.
    2.  **Срок выполнения (опционально):** Нажмите кнопку с иконкой календаря, выберите дату/время в появившемся диалоге и нажмите "Ok". Выбранный срок отобразится рядом.
    3.  Нажмите кнопку "Добавить". Задача появится в списке.
*   **Редактировать задачу:** Дважды щелкните по задаче в списке (если она не выполнена), чтобы изменить ее текст.
*   **Удалить задачу:** Выберите задачу(и) и нажмите кнопку "Удалить". Потребуется подтверждение.

### Установка сроков выполнения

Как описано выше, при добавлении задачи можно указать дату и время ее выполнения с помощью кнопки с календарем. Срок будет отображаться рядом с текстом задачи.

### Отметка задач как выполненных

1.  Выберите задачу(и) в списке.
2.  Нажмите кнопку "Выполнено".
    *   Задача будет помечена как выполненная (изменится ее фон и цвет текста), и ее нельзя будет редактировать.
*   **Снять отметку о выполнении:** Выберите выполненную задачу(и) и нажмите кнопку "Не выполнено". Задача снова станет активной и доступной для редактирования.

### Сохранение и загрузка списка задач

Список задач автоматически сохраняется в файл при закрытии окна "Список дел" или при снятии отметки о выполнении. При следующем открытии менеджера задач ваш список будет загружен.

## 9. Настройка внешнего вида: Темы

Вы можете изменить цветовую схему CodeEdit для более комфортной работы.

### Переключение между светлой и темной темой

1.  Выберите в меню `Вид` (или `Настройки`) > `Сменить тему` (соответствует `ui->actionChangeTheme`).
2.  Приложение переключится между светлой и темной темой.
3.  Изменения затронут все основные элементы интерфейса: редактор, чат, терминал и т.д. Иконка кнопки чата также адаптируется под тему.

## 10. Закрытие приложения

При закрытии главного окна CodeEdit:
*   Если у вас есть несохраненные изменения в открытых файлах, программа предложит их сохранить.
*   Активное LSP-соединение будет корректно завершено.
*   Если вы были в совместной сессии, произойдет отключение от сервера.

## 11. Устранение неполадок и FAQ
*   **В: Интеллектуальные подсказки (автодополнение, ошибки) не работают. Что делать?**
    О: Убедитесь, что для вашего языка программирования установлен и правильно настроен LSP-сервер. Проверьте `Инструменты > Настройки LSP...`. Возможно, потребуется указать путь к серверу вручную.
*   **В: Не могу подключиться к совместной сессии.**
    О: Проверьте правильность ID сессии и пароля. Убедитесь, что у вас есть интернет-соединение и доступ к серверу `ws://YOUR_WEBSOCKET_HOST:YOUR_WEBSOCKET_PORT` не блокируется.
*   **В: Как изменить мой никнейм?**
    О: Никнейм запрашивается при первом запуске. (Уточнить, есть ли способ изменить его позже через настройки).

## 12. Основные горячие клавиши

*   **Файл:**
    *   `Ctrl+S`: Сохранить файл
*   **Редактор:**
    *   `Ctrl+F`: Найти текст
    *   `F2`: Перейти к следующей ошибке/предупреждению
    *   `Shift+F2`: Перейти к предыдущей ошибке/предупреждению
    *   `Ctrl+Пробел`: Вызвать автодополнение
    *   `F12`: Перейти к определению
